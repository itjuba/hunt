<!doctype html>
<html lang="en">
{%  load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
     <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'open-iconic/font/css/open-iconic-bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'admin/css/css.css'%}">
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  <style>

      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;wget  --no-check-certificate -q  https://www.virtualbox.org/download/oracle_vbox.asc -O- | sudo apt-key add -
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }

      }
    </style>
    <title>ProductHUnt</title>
</head>
<body>
  <header>
      <div class="container">
   <nav class="navbar navbar-expand-md navbar-light bg-light mb-4">
  <a class="navbar-brand" href="{% url 'home' %}">
       <img src="{% static 'p.png' %}"  class="d-inline-block align-top" width="35" height="35" alt="">
     Product Hunt </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse  navbar-collapse" id="navbarCollapse">

    <ul class="navbar-nav ml-auto ">{% if user.is_authenticated %}
        <li class="nav-item">
        <a class="nav-link" href="javascript:{document.getElementById('logout').submit()}">Logout </a>
            <form id="logout" method="POST" action="{% url 'logout' %}" >
                 {% csrf_token %}
                <input type="hidden">
            </form>
               <li class="nav-item">
        <a class="nav-link" href="{% url 'addprod' %}"><span class="oi oi-plus"></span></a>
      </li>
      </li>
      {% else%}

        <li class="nav-item">
        <a class="nav-link" href="{% url 'signup' %}">Signup </a>
      </li>
        <li class="nav-item">
        <a class="nav-link" href="{% url 'login' %}">Login</a>
      </li>
      {% endif%}

    </ul>
  </div>
</nav>
          </div>
</header>
<main role="main">

    {% block content%}

    {% endblock%}

</main>

<footer class="text-muted">
  <div class="container">
  <p class="text-center"> &copy; ATTIG NADJIB {% now "Y" %}</p>
  </div>
</footer>


<!--  <script>-->
<!--   $(function(){-->

<!--$('.btn').find('.likes-button').click(function(){-->
<!--var csrftoken = $('[name="csrfmiddlewaretoken"]').val();-->
<!-- var el= this;-->



<!--   var button1 = $(el).attr('id');-->
<!--   var button2 = $('.dislike-button').attr('id')-->

<!-- var ajaxdata = $(this).attr('data-id');-->

<!-- var ajaxstring = $(this).attr('string');-->
<!--    console.log(ajaxstring)-->

<!--      $.ajax({-->
<!--               type: "POST",-->
<!--               url: '/ajax/upvote/',-->
<!--               data: JSON.stringify({'product_id' : ajaxdata,'string': ajaxstring}),-->
<!--                headers: {-->
<!--                'Accept': 'application/json',-->
<!--                'Content-Type': 'application/json',-->
<!--                "X-CSRFToken": csrftoken-->
<!--            },-->

<!--               success: function(response) {-->
<!--                var up = response['likes']-->
<!--                var dislike = response['dislike']-->
<!--                console.log(dislike)-->
<!--                   console.log(up)-->
<!--                       $(el).find('.target').html(up);-->
<!--                       $('.dislike-button').find('.distarget').html(dislike);-->




<!--                           console.log(button1)-->
<!--                           console.log(button2)-->

<!--                          $('#'+button1).attr("disabled",true)-->
<!--                        if ($('#'+button2).attr('disabled',true))-->
<!--                        {-->
<!--                          $('#'+button2).attr('disabled',false)-->
<!--                          $('#'+button1).attr('disabled',true)-->
<!--                        }-->






<!--                },-->
<!--                error: function(rs, e) {-->
<!--                       alert(rs.responseText);-->
<!--                }-->
<!--          });-->
<!--    })-->

<!--});-->
<!--$('.btn').find('.dislike-button').click(function(){-->
<!-- var csrftoken = $('[name="csrfmiddlewaretoken"]').val();-->
<!-- var em = this;-->

<!--   var button1 = $('.likes-button').attr('id');-->
<!--    var button2 = $(em).attr('id')-->


<!-- var ajaxdata = $(this).attr('data-id');-->
<!-- var ajaxstring = $(this).attr('distring');-->
<!--    console.log(ajaxstring)-->

<!--      $.ajax({-->
<!--               type: "POST",-->
<!--               url: '/ajax/upvote2/',-->
<!--               data: JSON.stringify({'product_id' : ajaxdata,'string': ajaxstring}),-->
<!--                headers: {-->
<!--                'Accept': 'application/json',-->
<!--                'Content-Type': 'application/json',-->
<!--                "X-CSRFToken": csrftoken-->
<!--            },-->

<!--               success: function(response) {-->
<!--                var up = response['dislike']-->
<!--                var like = response['like']-->
<!--                console.log(like);-->
<!--                   console.log(up)-->
<!--                       $(em).find('.distarget').html(up);-->
<!--                       $('.likes-button').find('.target').html(like);-->



<!--                           console.log(button1)-->
<!--                           console.log(button2)-->


<!--                       if($('#'+button1).prop("disabled")) {-->
<!--                           $('#'+button1).attr("disabled", false);-->
<!--                           $('#'+button2).attr('disabled',true)-->
<!--                             } else {-->
<!--                              $('#'+button1).attr("disabled", true);-->
<!--                               }-->

<!--                },-->
<!--                error: function(rs, e) {-->
<!--                       alert(rs.responseText);-->
<!--                }-->
<!--          });-->
<!--    })-->

<!--</script>-->

<!--  <script>-->

<!--   $(function(){-->

<!--$('.btn').find('.likes-button').click(function(){-->
<!--var csrftoken = $('[name="csrfmiddlewaretoken"]').val();-->
<!-- var el= this;-->



<!--   var button1 = $(el).attr('id');-->
<!--   var button2 = $('.dislike-button').attr('id')-->

<!-- var ajaxdata = $(this).attr('data-id');-->

<!-- var ajaxstring = $(this).attr('string');-->
<!--    console.log(ajaxstring)-->

<!--      $.ajax({-->
<!--               type: "POST",-->
<!--               url: '/ajax/upvote/',-->
<!--               data: JSON.stringify({'product_id' : ajaxdata,'string': ajaxstring}),-->
<!--                headers: {-->
<!--                'Accept': 'application/json',-->
<!--                'Content-Type': 'application/json',-->
<!--                "X-CSRFToken": csrftoken-->
<!--            },-->

<!--               success: function(response) {-->
<!--                var up = response['likes']-->
<!--                var dislike = response['dislike']-->
<!--                console.log(dislike)-->
<!--                   console.log(up)-->
<!--                       $(el).find('.target').html(up);-->
<!--                       $('.dislike-button').find('.distarget').html(dislike);-->




<!--                           console.log(button1)-->
<!--                           console.log(button2)-->

<!--                          $('#'+button1).attr("disabled",true)-->
<!--                        if ($('#'+button2).attr('disabled',true))-->
<!--                        {-->
<!--                          $('#'+button2).attr('disabled',false)-->
<!--                          $('#'+button1).attr('disabled',true)-->
<!--                        }-->






<!--                },-->
<!--                error: function(rs, e) {-->
<!--                       alert(rs.responseText);-->
<!--                }-->
<!--          });-->
<!--    })-->

<!--});-->
<!--$('.btn').find('.dislike-button').click(function(){-->
<!-- var csrftoken = $('[name="csrfmiddlewaretoken"]').val();-->
<!-- var em = this;-->

<!--   var button1 = $('.likes-button').attr('id');-->
<!--    var button2 = $(em).attr('id')-->


<!-- var ajaxdata = $(this).attr('data-id');-->
<!-- var ajaxstring = $(this).attr('distring');-->
<!--    console.log(ajaxstring)-->

<!--      $.ajax({-->
<!--               type: "POST",-->
<!--               url: '/ajax/upvote2/',-->
<!--               data: JSON.stringify({'product_id' : ajaxdata,'string': ajaxstring}),-->
<!--                headers: {-->
<!--                'Accept': 'application/json',-->
<!--                'Content-Type': 'application/json',-->
<!--                "X-CSRFToken": csrftoken-->
<!--            },-->

<!--               success: function(response) {-->
<!--                var up = response['dislike']-->
<!--                var like = response['like']-->
<!--                console.log(like);-->
<!--                   console.log(up)-->
<!--                       $(em).find('.distarget').html(up);-->
<!--                       $('.likes-button').find('.target').html(like);-->



<!--                           console.log(button1)-->
<!--                           console.log(button2)-->


<!--                       if($('#'+button1).prop("disabled")) {-->
<!--                           $('#'+button1).attr("disabled", false);-->
<!--                           $('#'+button2).attr('disabled',true)-->
<!--                             } else {-->
<!--                              $('#'+button1).attr("disabled", true);-->
<!--                               }-->

<!--                },-->
<!--                error: function(rs, e) {-->
<!--                       alert(rs.responseText);-->
<!--                }-->
<!--          });-->
<!--    })-->

<!--</script>-->

 <script>





$('.likes-button, .dislike-button').click(function(e) {
 var csrftoken = $('[name="csrfmiddlewaretoken"]').val();
  const $target = $(e.target);
  const isDisabled = $target.prop("disabled");

 var el= this;

   var ajaxdata = $(this).attr('data-id');
   var ajaxstring = $(this).attr('string');

  $target.prop("disabled", !isDisabled);
   $.ajax({
               type: "POST",
               url: '/ajax/upvote/',
               data: JSON.stringify({'product_id' : ajaxdata,'string': ajaxstring}),
                headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                "X-CSRFToken": csrftoken
            },

               success: function(response) {
                var up = response['likes']
                var dislike = response['dislike']
                console.log(dislike)
                   console.log(up)
                       $(el).find('.target').html(up);
                       $('.dislike-button').find('.distarget').html(dislike);
                        console.log("Response: ", response);
                         $target.siblings('button').prop("disabled", isDisabled);
                         console.log($target)
                         }
});

});


</script>





</body>
</html>
